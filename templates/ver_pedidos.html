<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Registro de Pedidos</title>
   <link rel="stylesheet" href="{{ url_for('static', filename='css/ver_pedidos.css') }}">

</head>
<body>

  <!-- ENCABEZADO PRINCIPAL -->
  <section class="contenido">
    <div class="titulo-seccion">
      <h2>REGISTRO DE PEDIDOS</h2>
      <h1>Maki Roll</h1>
    </div>
  </section>

  

  <!-- Botón para abrir/cerrar -->
  <label for="menu-toggle" class="menu-btn">&#9776;</label>
  <input type="checkbox" id="menu-toggle">

  <!-- Menú lateral -->
<div class="menu">
  <a id="inicio">Inicio</a>
  <a id="ventas">ventas</a>
  <a id="menuEdt">Menu Edt</a>
  <a id="pedidos">Pedidos Reg</a>
  <a id="ruletaPremios">Ruleta de premios</a>
  <a id="ruletaConfig">Ruleta config</a>
</div>

  </div>

  <table id="tablaPedidos">
    <thead>
      <tr>
        <th>ID Pedido</th>
        <th>Platillo</th>
        <th>Cliente</th>
        <th>Usuario</th>
        <th>Dirección</th>
        <th>Teléfono</th>
        <th>Código Postal</th>
        <th>Tipo Vivienda</th>
        <th>Referencia</th>
        <th>Comentarios</th>
        <th>Fecha y Hora</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <button id="recargar">Recargar</button>

  <script>
    async function cargarPedidos() {
  try {
    const respuesta = await fetch("/obtener_pedidos");
    const pedidos = await respuesta.json();

    const cuerpoTabla = document.querySelector("#tablaPedidos tbody");
    cuerpoTabla.innerHTML = "";

    if (pedidos.length === 0) {
      cuerpoTabla.innerHTML = `<tr><td colspan="11">No hay pedidos registrados.</td></tr>`;
      return;
    }

    pedidos.forEach(p => {
      const fila = document.createElement("tr");
      fila.innerHTML = `
        <td>${p.id_pedido}</td>
        <td>${p.platillo || "—"}</td>
        <td>${p.nombre_cliente || "—"}</td>
        <td>${p.nombre_usuario || "—"}</td>
        <td>${p.direccion || "—"}</td>
        <td>${p.telefono || "—"}</td>
        <td>${p.codigo_postal || "—"}</td>
        <td>${p.tipo_vivienda || "—"}</td>
        <td>${p.referencia || "—"}</td>
        <td>${p.comentarios || "—"}</td>
        <td>${p.fecha_hora ? new Date(p.fecha_hora).toLocaleString() : "—"}</td>
      `;
      cuerpoTabla.appendChild(fila);
    });
  } catch (error) {
    console.error("Error al cargar pedidos:", error);
    alert("Hubo un error al obtener los pedidos.");
  }
}

document.getElementById("recargar").addEventListener("click", cargarPedidos);
cargarPedidos();
  </script>

      <script src="{{ url_for('static', filename='js/ver_pedidos.js') }}"></script>
      <script src="{{ url_for('static', filename='js/gestion_roles.js') }}"></script>

</body>
</html>
